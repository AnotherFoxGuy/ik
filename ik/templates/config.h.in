/* -------------------------------------------------------------------------
 * Configures prerequisite for this library
 * ------------------------------------------------------------------------- */

#ifndef IK_CONFIG_H
    #define IK_CONFIG_H

    /* ---------------------------------------------------------------------
     * Build settings
     * --------------------------------------------------------------------- */

#   define IKAPI ${IK_API_NAME}
    #cmakedefine IK_BENCHMARKS
    #cmakedefine IK_DOT_EXPORT
    #cmakedefine IK_HAVE_STDINT_H
    #cmakedefine IK_MEMORY_DEBUGGING
#   ifdef IK_MEMORY_DEBUGGING
        #cmakedefine IK_MEMORY_BACKTRACE
#   endif
    #cmakedefine IK_HASHMAP_STATS
#   define IK_PRECISION_${IK_PRECISION_CAPS_AND_NO_SPACES}
    #cmakedefine IK_PIC
    #cmakedefine IK_PROFILING
    #cmakedefine IK_PYTHON
    #cmakedefine IK_TESTS

    /* ---------------------------------------------------------------------
     * Helpers
     * --------------------------------------------------------------------- */

    /* Helpful for making sure functions are being used */
#   define IK_WARN_UNUSED ${IK_WARN_UNUSED}

    /* Visibility macros */
#   define IK_HELPER_API_EXPORT ${IK_HELPER_API_EXPORT}
#   define IK_HELPER_API_IMPORT ${IK_HELPER_API_IMPORT}
#   define IK_HELPER_API_LOCAL  ${IK_HELPER_API_LOCAL}
#   if defined (IK_BUILDING)  /* defined only when the library is being compiled using a command line option, e.g. -DIK_BUILDING */
#       define IK_PUBLIC_API IK_HELPER_API_EXPORT
#   else
#       define IK_PUBLIC_API IK_HELPER_API_IMPORT
#   endif
#   define IK_PRIVATE_API IK_HELPER_API_LOCAL

    /* C linkage */
#   ifdef __cplusplus
#       define C_BEGIN extern "C" {
#       define C_END }
#   else
#       define C_BEGIN
#       define C_END
#   endif

#   define IK_FAIL(errcode, label) do { \
        status = errcode; \
        goto label; \
    } while (0)

    /* --------------------------------------------------------------
     * Common include files
     * --------------------------------------------------------------*/

    #include "ik/retcodes.h"

    #ifdef IK_HAVE_STDINT_H
        #include <stdint.h>
    #else
        #include "ik/pstdint.h"
    #endif

    /* --------------------------------------------------------------
     * Types
     * --------------------------------------------------------------*/

    /* The "real" datatype to be used throughout the library */
typedef ${IK_PRECISION} ikreal_t;

    /* Define epsilon depending on the type of "real" */
#   include <float.h>
#   if defined(IK_PRECISION_LONG_DOUBLE)
#       define IK_EPSILON DBL_EPSILON
#   elif defined(IK_PRECISION_DOUBLE)
#       define IK_EPSILON DBL_EPSILON
#   elif defined(IK_PRECISION_FLOAT)
#       define IK_EPSILON FLT_EPSILON
#   else
#       error Unknown precision. Are you sure you defined IK_PRECISION and IK_PRECISION_CAPS_AND_NO_SPACES?
#   endif

#   ifdef IK_VECTOR_64BIT
typedef uintptr_t vector_size_t;
#   else
typedef uint32_t vector_size_t;
#   endif

#endif /* IK_CONFIG_H */
